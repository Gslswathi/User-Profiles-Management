<div class="container mt-5">
  <div class="card shadow">
    <div class="card-body">
      <h4 class="mb-4 text-center">User Profile</h4>

      <div *ngIf="loading">Loading...</div>
      <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

      <form [formGroup]="profileForm" (ngSubmit)="save()">

        <!-- Tabs -->
        <ul class="nav nav-tabs mb-3">
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeTab==='basic'" (click)="setActiveTab('basic')">
              Basic Details
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeTab==='education'" (click)="setActiveTab('education')">
              Education
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeTab==='contact'" (click)="setActiveTab('contact')">
              Contact Info
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="activeTab==='other'" (click)="setActiveTab('other')">
              Other
            </a>
          </li>
        </ul>

        <!-- BASIC DETAILS TAB -->
        <div *ngIf="activeTab==='basic'">
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Full Name</label>
              <input formControlName="name" class="form-control" [readonly]="!editMode" />
              <div *ngIf="profileForm.get('name')?.touched && profileForm.get('name')?.invalid" class="text-danger small">Name is required.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Designation</label>
              <input formControlName="designation" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Date of Birth</label>
              <input type="date" formControlName="dob" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Gender</label>
              <input formControlName="gender" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
        </div>

        <!-- EDUCATION TAB -->
        <div *ngIf="activeTab==='education'">
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">School / College</label>
              <input formControlName="school" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Course</label>
              <input formControlName="course" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Degree</label>
              <input formControlName="degree" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Year of Completion</label>
              <input formControlName="yearOfCompletion" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Grade</label>
              <input formControlName="grade" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
        </div>

        <!-- CONTACT INFO TAB -->
        <div *ngIf="activeTab==='contact'">
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Email</label>
              <input formControlName="email" class="form-control" [readonly]="!editMode" />
              <div *ngIf="profileForm.get('email')?.touched && profileForm.get('email')?.invalid" class="text-danger small">Enter a valid email.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Phone</label>
              <input formControlName="phone" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-12">
              <label class="form-label">Address</label>
              <textarea formControlName="address" class="form-control" rows="3" [readonly]="!editMode"></textarea>
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-4">
              <label class="form-label">Pincode</label>
              <input formControlName="pincode" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-4">
              <label class="form-label">Country</label>
              <input formControlName="country" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-4">
              <label class="form-label">LinkedIn</label>
              <input formControlName="linkedIn" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-12">
              <label class="form-label">Resume (filename)</label>
              <input formControlName="resume" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
        </div>

        <!-- OTHER TAB -->
        <div *ngIf="activeTab==='other'">
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Skills</label>
              <input formControlName="skills" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Domain</label>
              <input formControlName="domain" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label">Sub Domain</label>
              <input formControlName="subDomain" class="form-control" [readonly]="!editMode" />
            </div>
            <div class="col-md-6">
              <label class="form-label">Experience</label>
              <input formControlName="experience" class="form-control" [readonly]="!editMode" />
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex justify-content-between mt-3">
          <div>
            <button type="button" class="btn btn-secondary" (click)="goBack()">Back</button>
          </div>
          <div>
            <button *ngIf="!editMode" type="button" class="btn btn-primary" (click)="enableEdit()">Edit</button>
            <button *ngIf="editMode" type="submit" class="btn btn-success" [disabled]="profileForm.invalid">Save</button>
            <button *ngIf="editMode" type="button" class="btn btn-outline-secondary ms-2" (click)="cancelEdit()">Cancel</button>
          </div>
        </div>

      </form>

    </div>
  </div>
</div>
